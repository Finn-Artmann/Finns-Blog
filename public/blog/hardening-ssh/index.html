<!doctype html><html lang="en-us">
  <head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="generator" content="Qubt theme for Hugo" />



<title>Finn&#39;s Blog &gt;</title>
<meta name="title" content="Finn&#39;s Blog &gt;" />



  <meta name="author" content="Finn-Artmann" />




  <meta name="description" content="Site build with Qubt &amp; Hugo" />









<link type="text/css" rel="stylesheet" href="/css/main.bundle.min.f2d16a448b21611d0a4144f1f6af28b9319806e8e331beb52ed72e145b97a3f9.css" integrity="sha256-8tFqRIshYR0KQUTx9q8ouTGYBujjMb61LtcuFFuXo/k=" />









<script defer src="/js/main.bundle.min.5a00293bacd8510f50add105212cea76d541a955f6693035ef3128b638a21619.js" integrity="sha256-WgApO6zYUQ9QrdEFISzqdtVBqVX2aTA17zEotjiiFhk="></script>




  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/icon_hu9321328739220491146.webp" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icon_hu6857626339409758674.webp" />



<meta property="og:url" content="https://finn-cloud.de/blog/hardening-ssh/">
  <meta property="og:site_name" content="Finn&#39;s Blog &gt;">
  <meta property="og:title" content="Hardening SSH login on your VPS">
  <meta property="og:description" content="Secure your VPS by hardening the SSH login">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-10-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-01T00:00:00+00:00">
    <meta property="og:image" content="https://finn-cloud.de/thumbnail.png">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://finn-cloud.de/thumbnail.png">
  <meta name="twitter:title" content="Hardening SSH login on your VPS">
  <meta name="twitter:description" content="Secure your VPS by hardening the SSH login">


<script>
  
  if (localStorage.getItem("color-theme") === "dark" || (!("color-theme" in localStorage) && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
    document.documentElement.classList.add("dark");
  } else {
    document.documentElement.classList.remove("dark");
  }
</script>

  </head>
  <body class="flex h-screen flex-col justify-between bg-neutral-100 dark:bg-neutral-800">
    <div>
      <header class="sticky top-0 z-10 bg-neutral-100 dark:bg-neutral-800">
        



<section class="mx-auto flex max-w-screen-xl items-center justify-between p-4">
  <a href="https://finn-cloud.de/" class="flex items-center space-x-3">
    
      
      <img src="/logo_hu7723447451981714320.webp" class="h-8 w-8" alt="Logo" />
    
    <span class="self-center whitespace-nowrap text-2xl font-semibold text-slate-700 dark:text-slate-400">
      Finn&#39;s Blog &gt;
    </span>
  </a>
  <div class="flex flex-row space-x-8">
    <nav class="hidden space-x-8 text-xl md:block" aria-label="main">
      
        <a href="/" class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">
          Home
        </a>
      
        <a href="/blog/" class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">
          Blog
        </a>
      
        <a href="/about/" class="px-3 py-2 text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">
          About
        </a>
      
    </nav>
    <button id="theme-toggle" type="button" class="rounded-lg text-sm text-slate-700 hover:text-indigo-500 dark:text-slate-400" aria-label="theme-switcher">
      <svg id="theme-toggle-dark-icon" class="hidden h-6 w-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
      </svg>
      <svg id="theme-toggle-light-icon" class="hidden h-6 w-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
          fill-rule="evenodd"
          clip-rule="evenodd"></path>
      </svg>
    </button>
    <button id="hamburger-button" class="relative h-8 w-8 cursor-pointer text-3xl md:hidden" aria-label="hamburger-button">
      <div
        class="absolute top-4 -mt-0.5 h-[3px] w-8 rounded bg-slate-700 transition-all duration-500 before:absolute before:h-[3px] before:w-8 before:-translate-x-4 before:-translate-y-2.5 before:rounded before:bg-slate-700 before:transition-all before:duration-500 before:content-[''] after:absolute after:h-[3px] after:w-8 after:-translate-x-4 after:translate-y-2.5 after:rounded after:bg-slate-700 after:transition-all after:duration-500 after:content-[''] dark:bg-slate-400 before:dark:bg-slate-400 after:dark:bg-slate-400"></div>
    </button>
  </div>
</section>
<section id="mobile-menu" class="absolute hidden w-full origin-top animate-open-menu flex-col justify-center bg-neutral-100 text-4xl dark:bg-neutral-800">
  <nav class="flex min-h-screen flex-col items-center py-8" aria-label="mobile">
    
      <a href="/" class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">
        Home
      </a>
    
      <a href="/blog/" class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">
        Blog
      </a>
    
      <a href="/about/" class="px-3 py-2 text-center text-slate-700 hover:text-indigo-500 dark:text-slate-400 md:p-0">
        About
      </a>
    
  </nav>
</section>

      </header>
      <main>
        
  
  
  
  
  


  <div class="justify-left mx-auto mt-8 flex max-w-screen-md px-4">
    <article>
      <h1 class="text-4xl font-extrabold text-slate-700 dark:text-slate-200">
        Hardening SSH login on your VPS
      </h1>
      <h2 class="mt-4 text-2xl text-slate-500 dark:text-slate-400">
        Secure your VPS against unauthorized access
      </h2>
      <div class="mb-4 mt-2 text-sm text-slate-500 dark:text-slate-400">
        Oct 1, 2024 - 3 minute read
      </div>

      

      


      <span class="prose prose-slate break-words text-lg text-slate-700 dark:prose-invert prose-pre:max-w-[90vw] dark:text-slate-200 md:prose-pre:max-w-screen-md">
        <h3 id="introduction">Introduction</h3>
<p>In this guide, I will walk you through hardening the SSH login on your VPS to secure it against unauthorized access. Typically, attackers target SSH services often via brute-force attacks to gain access to your server. Credit to <a href="https://www.youtube.com/watch?v=F-9KWQByeU0">Dreams of Code</a> as I mainly only compiled the information from this video, but I highly recommend watching it for a more in-depth explanation.</p>
<h3 id="prequisites">Prequisites</h3>
<ul>
<li>A VPS with SSH access: For this guide we will assume you have a VPS with SSH access reachable via an example IP address <code>1.2.3.4</code>.</li>
</ul>
<h3 id="step-1-disable-root-login">Step 1: Disable root login</h3>
<h4 id="11-login-to-your-vps">1.1 Login to your VPS</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh root@1.2.3.4
</span></span></code></pre></div><p>Enter your password provided by your VPS provider when prompted.</p>
<h4 id="12-add-a-new-non-root-user">1.2 Add a new non-root user</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adduser mynewuser
</span></span></code></pre></div><p>Set &lsquo;mynewuser&rsquo; as your preferred username and provide a password for the new user when prompted.</p>
<h4 id="13-add-the-new-user-to-the-sudo-group">1.3 Add the new user to the sudo group</h4>
<p>This step is required to allow the new user to execute commands with root privileges when needed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>usermod -aG sudo mynewuser
</span></span></code></pre></div><h4 id="14-test-the-new-user">1.4 Test the new user</h4>
<p>Test the new user by switching to it and running a command with sudo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su - mynewuser
</span></span><span style="display:flex;"><span>sudo ls /
</span></span></code></pre></div><h3 id="step-2-disable-password-authentication">Step 2: Disable password authentication</h3>
<h4 id="21-set-up-ssh-key-based-authentication">2.1 Set up SSH key-based authentication</h4>
<p>Exit the vps and make sure your new user has a copy of your ssh key.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>exit
</span></span></code></pre></div><p>On your local machine, copy your public ssh key to the new user on the vps.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-copy-id mynewuser@1.2.3.4
</span></span></code></pre></div><h4 id="22-test-key-based-authentication">2.2 Test key-based authentication</h4>
<p>Try to login to your VPS with the new user. The login should not prompt you for a password.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh mynewuser@1.2.3.4
</span></span></code></pre></div><h3 id="step-3-disable-password-authentication">Step 3: Disable password authentication</h3>
<h4 id="31-modify-the-ssh-configuration-file-to-disable-password-authentication">3.1 Modify the SSH configuration file to disable password authentication</h4>
<p>Modify the SSH configuration file to disable password authentication.
Log back into your VPS as the new user and open the SSH configuration file in a text editor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo vi /etc/ssh/sshd_config
</span></span></code></pre></div><p>Uncomment the following line in the file and change the value to <code>no</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PasswordAuthentication no
</span></span></code></pre></div><p>Disable root login by uncommenting the following line and changing the value to <code>no</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>PermitRootLogin no
</span></span></code></pre></div><p>Disable PAM authentication by uncommenting the following line and changing the value to <code>no</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>UsePAM no
</span></span></code></pre></div><p>Depending on your VPS provider, there might be additional configurations files for password authentication that you need to modify.</p>
<h4 id="32-restart-the-ssh-service">3.2 Restart the SSH service</h4>
<p>Reload the SSH service to apply the changes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl reload sshd
</span></span></code></pre></div><h3 id="33-test-the-changes">3.3 Test the changes</h3>
<p>Exit the VPS and try to log back in with the root user. The login should fail and output a message indicating &lsquo;Permission denied&rsquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh root@1.2.3.4
</span></span><span style="display:flex;"><span>Output: root@1.2.3.4: Permission denied <span style="color:#f92672">(</span>publickey<span style="color:#f92672">)</span>.
</span></span></code></pre></div><h3 id="step-4-configure-ssh-port-optional">Step 4: Configure SSH port (optional)</h3>
<p>An additional step you might consider is changing the default SSH port to a custom port to reduce the number of automated attacks on your server.
Keep in mind to take note of the custom port as other services you configure might need to know it.</p>
<p>This is especially important when you configure a firewall on your VPS, as you need to allow the custom port for SSH access. Whether or not you change the port, it is crucial to configure a firewall to allow traffic to the SSH port (the default porrt 22 or your custom port), otherwise you will have trouble logging back into your VPS!</p>
<p>In case you did lock yourself out though, usually the VPS provider provides a console access to your VPS or other recovery options to regain access.</p>
<p>The change can also be made in the SSH configuration file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo vi /etc/ssh/sshd_config
</span></span></code></pre></div><p>Change the port number in the file to your desired custom port.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Port <span style="color:#ae81ff">2222</span>
</span></span></code></pre></div>
      </span>
    </article>
  </div>

      </main>
    </div>
    <footer>
      <div class="flex flex-col justify-center p-10">
  
  <p class="text-center text-slate-700 dark:text-slate-400">
    
      &copy;
      2024
      Finn-Artmann
    
  </p>

  
  
  
  
  <p class="text-center text-sm text-slate-700 dark:text-slate-400">
    Published with <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href="https://gohugo.io" target="_blank" rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-indigo-500 hover:text-indigo-500" href="https://github.com/chrede88/qubt" target="_blank" rel="noopener noreferrer">Qubt</a>
  </p>
</div>

    </footer>
  </body>
</html>
